!function(e){e.fn.materialbox_new=function(){return this.each(function(){if(!e(this).hasClass("initialized")){e(this).addClass("initialized");var t,i,a=!1,o=!0,n=200,l=e(this),s=e("<div></div>").addClass("material-placeholder");l.wrap(s),l.on("click",function(){var n=l.parent(".material-placeholder"),s=window.innerWidth,c=window.innerHeight,r=l.width(),u=l.height(),p=l[0].naturalWidth,h=l[0].naturalHeight;if(p>s&&(p=s),h>c&&(h=c),!1===o)return d(),!1;if(a&&!0===o)return d(),!1;o=!1,l.addClass("active"),a=!0,n.css({width:n[0].getBoundingClientRect().width,height:n[0].getBoundingClientRect().height,position:"relative",top:0,left:0}),t=void 0,i=n[0].parentNode;for(;null!==i&&!e(i).is(document);){var f=e(i);"visible"!==f.css("overflow")&&(f.css("overflow","visible"),t=void 0===t?f:t.add(f)),i=i.parentNode}l.css({position:"absolute","z-index":1e3}).data("width",r).data("height",u);var v=e('<div id="materialbox-overlay"></div>').css({opacity:0}).click(function(){!0===o&&d()});if(l.before(v),v.velocity({opacity:1},{duration:275,queue:!1,easing:"easeOutQuad"}),""!==l.data("caption")){var m=e('<div class="materialbox-caption"></div>');m.text(l.data("caption")),e("body").append(m),m.css({display:"inline"}),m.velocity({opacity:1},{duration:275,queue:!1,easing:"easeOutQuad"})}var g=0,w=0;r/p>u/h?(g=.9*p,w=.9*p*(u/r)):(g=.9*h*(r/u),w=.9*h),l.hasClass("responsive-img")?l.velocity({"max-width":g,width:r},{duration:0,queue:!1,complete:function(){l.css({left:0,top:0}).velocity({height:w,width:g,left:e(document).scrollLeft()+s/2-l.parent(".material-placeholder").offset().left-g/2,top:e(document).scrollTop()+c/2-l.parent(".material-placeholder").offset().top-w/2},{duration:275,queue:!1,easing:"easeOutQuad",complete:function(){o=!0}})}}):l.css("left",0).css("top",0).velocity({height:w,width:g,left:e(document).scrollLeft()+s/2-l.parent(".material-placeholder").offset().left-g/2,top:e(document).scrollTop()+c/2-l.parent(".material-placeholder").offset().top-w/2},{duration:275,queue:!1,easing:"easeOutQuad",complete:function(){o=!0}})}),e(window).scroll(function(){a&&d()}),e(document).keyup(function(e){27===e.keyCode&&!0===o&&a&&d()})}function d(){o=!1;var i=l.parent(".material-placeholder"),s=l.data("width"),d=l.data("height");l.velocity("stop",!0),e("#materialbox-overlay").velocity("stop",!0),e(".materialbox-caption").velocity("stop",!0),e("#materialbox-overlay").velocity({opacity:0},{duration:n,queue:!1,easing:"easeOutQuad",complete:function(){a=!1,e(this).remove()}}),l.velocity({width:s,height:d,left:0,top:0},{duration:n,queue:!1,easing:"easeOutQuad"}),e(".materialbox-caption").velocity({opacity:0},{duration:n,queue:!1,easing:"easeOutQuad",complete:function(){i.css({height:"",width:"",position:"",top:"",left:""}),l.css({height:"",top:"",left:"",width:"","max-width":"",position:"","z-index":""}),l.removeClass("active"),o=!0,e(this).remove(),t&&t.css("overflow","")}})}})}}(jQuery);